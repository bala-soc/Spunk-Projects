# Analyzing HTTP Log Using Splunk SIEM

## Introduction
HTTP (Hypertext Transfer Protocol) log files contain valuable information about web server activity, including requests, responses, user agents, and more. Analyzing HTTP logs using Splunk SIEM enables security professionals to monitor web traffic, detect anomalies, and identify potential security threats.

## Project Overview
In this project, we will upload sample HTTP log files to Splunk SIEM and perform various analyses to gain insights into web server activity within the network.

## Prerequisites
Before starting the project, ensure the following:
- Splunk instance is installed and configured.
- HTTP log data sources are configured to forward logs to Splunk.

## Steps to Upload Sample HTTP Log Files to Splunk SIEM

### 1. Prepare Sample HTTP Log Files
- Obtain sample [HTTP log files](https://www.secrepo.com/maccdc2012/http.log.gz) in a suitable format (e.g., text files).
- Ensure the log files contain relevant HTTP events, including timestamps, request methods, URLs, response codes, user agents, etc.
- Save the sample log files in a directory accessible by the Splunk instance.

### 2. Upload Log Files to Splunk
- Log in to the Splunk web interface.
- Navigate to **Settings** > **Add Data**.
<img width="863" height="771" alt="1" src="https://github.com/user-attachments/assets/38023c9e-d709-47cd-92f6-011da3954991" />

- Select **Upload** as the data input method.
<img width="1391" height="421" alt="2" src="https://github.com/user-attachments/assets/0f8574df-ef5d-434d-85b5-667b766e1e03" />

### 3. Choose File
- Click on **Select File** and choose the sample HTTP log file you prepared earlier.
<img width="1160" height="876" alt="3" src="https://github.com/user-attachments/assets/95044213-a5d6-43d2-8212-51a2af2cc83f" />

### 4. Set Source Type
- In the **Set Source Type** section, specify the source type for the uploaded log file.
- Choose the appropriate source type for HTTP logs (e.g., `access_combined` or a custom source type if applicable).
<img width="866" height="749" alt="4" src="https://github.com/user-attachments/assets/fffcf183-cabf-4144-a361-36b69abe804c" />

### 5. Review Settings
- Review other settings such as index, host, and sourcetype.
- Ensure the settings are configured correctly to match the sample HTTP log file.
<img width="1293" height="879" alt="5" src="https://github.com/user-attachments/assets/4952ba4f-09a9-4082-9932-97fa8d275505" />

### 6. Click Upload
- Once all settings are configured, click on the **Review** button.
- Review the settings one final time to ensure accuracy.
- Click **Submit** to upload the sample HTTP log file to Splunk.
<img width="1324" height="522" alt="6" src="https://github.com/user-attachments/assets/05151201-1ffd-4096-9660-7e6b6214d858" />


### 7. Verify Upload
- After uploading, navigate to the search bar in the Splunk interface.
<img width="1407" height="680" alt="7" src="https://github.com/user-attachments/assets/82a567e3-f37d-4862-9dbd-2781bc18795e" />

- Run a search query to verify that the uploaded HTTP events are visible.
<img width="1920" height="882" alt="8" src="https://github.com/user-attachments/assets/95cf4013-7be2-4a3b-ad7f-9c61e10ce12a" />


## Steps to Analyze HTTP Log Files in Splunk SIEM


### 1. Search for HTTP Events
- Open Splunk interface and navigate to the search bar.
- Enter the following search query to retrieve HTTP events:
```
index=_* OR index=* sourcetype=httplog
```
<img width="1920" height="882" alt="9" src="https://github.com/user-attachments/assets/1d77905a-b4f4-4063-a4c7-01beb01038ee" />

### 2. Extract Relevant Fields
- Identify key fields in HTTP logs such as timestamps, request methods, URLs, response codes, user agents, etc.
- Use Splunk's field extraction capabilities or regular expressions to extract these fields for better analysis.
- Example extraction command:
```
index=* sourcetype=httplog | rex field=_raw “(?<src_ip>\d{1,3}(?:\.\d{1,3}){3})\t(?<dest_ip>\d{1,3}(?:\.\d{1,3}){3})\t(?<status_code>\d{3})”
```
<img width="1920" height="885" alt="10" src="https://github.com/user-attachments/assets/714206e1-180e-4612-8fa5-ed652e5ec4cb" />

### 3. Analyze Web Traffic Patterns
- Determine the distribution of request methods (GET, POST, etc.) to understand web traffic patterns.
```
index=* sourcetype=httplog
| stats count by method
```
<img width="1920" height="886" alt="11" src="https://github.com/user-attachments/assets/fa2ea004-914a-4753-b981-a1fdd97c13b7" />

- Identify top URLs or endpoints accessed by users.
```
index=* sourcetype=httplog
| top limit=10 uri
```
<img width="1920" height="881" alt="12" src="https://github.com/user-attachments/assets/09382020-b9f2-4999-aafb-b02ffaeba353" />

- Analyze response codes to identify errors or successful requests.
```
index=* sourcetype=httplog
| stats count by status
```
<img width="1920" height="885" alt="13" src="https://github.com/user-attachments/assets/28286ae9-a706-4357-a399-801b8ae1f052" />

### 4. Detect Anomalies
- Look for unusual patterns in file transfer activity.
```
index=* sourcetype=httplog
| timechart span=4h count by status
```
<img width="1920" height="879" alt="14" src="https://github.com/user-attachments/assets/2be34806-f39a-4498-97c0-338fdda0014b" />

- Analyze high volumes of error responses:
```
index=* sourcetype=httplog
| where status >= 400
| stats count by status
```
<img width="1920" height="404" alt="15" src="https://github.com/user-attachments/assets/a26ae7f7-3a32-46e5-8915-214632f81caa" />

- Investigate file transfers to or from suspicious IP addresses.
```
index=* sourcetype=httplog
| top src_ip limit=10
```
<img width="1920" height="884" alt="16" src="https://github.com/user-attachments/assets/0fa7d9d8-a65f-4224-b7ae-889a4fd1e68a" />


### 5. Monitor User Behavior
- Identify users with multiple failed login attempts or unauthorized access attempts:
```
index=* sourcetype=httplog
| search action="login" status="failed"
| stats count by src_ip
| sort -count
```
<img width="1920" height="460" alt="17" src="https://github.com/user-attachments/assets/0ed14d06-283c-4f50-a40d-e5fab4494529" />


- Analyze user session durations and access patterns:
```
index=* sourcetype=httplog
| stats range(_time) as session_duration by session_id
| stats avg(session_duration) as avg_session_duration by user
```
<img width="1920" height="406" alt="18" src="https://github.com/user-attachments/assets/688a5f9f-4c1a-43e2-a7a3-6ae6d2297370" />

## Conclusion
Analyzing FTP log files using Splunk SIEM provides valuable insights into file transfer activities within a network. By monitoring FTP events, detecting anomalies, and correlating with other logs, organizations can enhance their security posture and protect against various cyber threats.




